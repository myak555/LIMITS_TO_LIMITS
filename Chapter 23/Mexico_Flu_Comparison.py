from COVID_19_Parcing import *

def Plot_Mexico_Flu1():
    World_Bank_Years = np.linspace(2000, 2019, 20)
    World_Bank_CDR = np.array(
        [4737,4703,4689,4700,4734,4792,4869,4961,5060,5163,
         5266,5369,5471,5572,5670,5763,5851,5933,6010,6100])
    Knoema_Years = np.linspace(2008, 2019, 12)
    Knoema_CDR = np.array(
        [5100,5200,5300,5400,5500,5600,5700,5800,5900,5900,6000,6100])
    Year, Total, Cardio_respiratory, Respiratory, Flu_pneumoia = Load_Calibration("./Data/Mexico_Flu.csv",
        ["Year", "Total", "Cardio_respiratory",	"Respiratory", "Flu_pneumoia"], separator='\t')
    Total_Sm = FilterN(Total, N=25)
    cc = Covid_Countries()
    cc.inputCountryFile( "Mexico", None)
    cou = cc.Countries["Mexico"]
    fig = plt.figure( figsize=(15,10))
    fig.suptitle( 'Смертность в Мексике', fontsize=22)
    gs = plt.GridSpec(1, 1, height_ratios=[1]) 
    ax1 = plt.subplot(gs[0])
    ax1.plot( Year, Total,  "-", lw=2, color="k", label="Всего")
    ax1.plot( Year, Total_Sm,  "-.", lw=2, color="k", label="Всего, сезонные флуктуации удалены")
    #ax1.plot( World_Bank_Years, World_Bank_CDR/10,  "--", lw=2, color="k", label="Всего (Wolrd Bank)")
    #ax1.plot( Knoema_Years, Knoema_CDR/12,  "--", lw=2, color="k", label="Всего (Knoema)")
    ax1.plot( Year, Cardio_respiratory, "-", lw=2, color="r", label="Все респираторные + cердечно-сосудистые")
    ax1.plot( Year, Respiratory, "-", lw=2, color="b", label="Все респираторные заболевания")
    ax1.plot( Year, Flu_pneumoia, "-", lw=2, color="m", label="Диагностированные грипп и пневмонии")
    aflu = np.average(Flu_pneumoia) 
    ax1.plot( [2000,2011], [aflu, aflu], "--", lw=2, color="m")   
    ax1.plot( [2006,2011], [6100/12, 6100/12], "--", lw=2, color="k", label="Общая смертность в 2019 г (ООН)")   
    ax1.text(2001, -100, 'Source: Vivek Charu, et al, "Mortality Burden of the A/H1N1 Pandemic in Mexico"', fontsize=12)
    ax1.set_xlabel('Год')        
    ax1.set_ylabel('Смертей на млн в месяц')
    ax1.grid(True)
    ax1.set_xlim(2000, 2011)
    ax1.set_ylim(0, 800)
    ax1.legend(loc=2, fontsize=14 )
    plt.savefig( "./Graphs/020_Mexico_Flu_1.png")
    return

def Plot_Mexico_Flu2():
    WHO_Years = np.linspace(2012, 2020, 9)
    WHO_Flu = np.array(
        [2.876,0.493,9.015,0.680,5.549,4.114,1.231,6.446,2.171])
    Year, Total, Cardio_respiratory, Respiratory, Flu_pneumoia = Load_Calibration("./Data/Mexico_Flu.csv",
        ["Year", "Total", "Cardio_respiratory",	"Respiratory", "Flu_pneumoia"], separator='\t')
    Total_Sm = FilterN(Total, N=25)
    cc = Covid_Countries()
    cc.inputCountryFile( "Mexico", None)
    cou = cc.Countries["Mexico"]
    fig = plt.figure( figsize=(15,10))
    fig.suptitle( 'Смертность от ОРВИ и пневмонии в Мексике', fontsize=22)
    gs = plt.GridSpec(1, 1, height_ratios=[1]) 
    ax1 = plt.subplot(gs[0])
    #ax1.plot( Year, Cardio_respiratory, "-", lw=2, color="r", label="Все респираторные + cердечно-сосудистые")
    ax1.plot( Year, Respiratory, "-", lw=2, color="b", label="Все респираторные (Vivek Charu, et al)")
    ax1.plot( Year, Flu_pneumoia, "-", lw=2, color="m", label="Диагностированныe грипп и пневмония (Vivek Charu, et al)")
    ax1.bar( WHO_Years+1/12, WHO_Flu, width=7/12, color="m", label="Тестированные смерти от гриппа 2011-2019 (WHO/Statista)")
    aflu = np.average(Flu_pneumoia) 
    ares = np.average(Respiratory) 
    ax1.plot( [2000,2021], [aflu, aflu], "--", lw=2, color="m")   
    ax1.plot( [2000,2021], [ares, ares], "--", lw=2, color="b")   
    #ax1.plot( [2011,2021], [6100/12, 6100/12], "--", lw=2, color="k", label="Общая смертность в 2019 г (ООН)")   
    ax1.bar( 2020+cou.Days/366, cou.dDeaths*30, width=1/366, color="r", label="COVID-19 (WHO)")
    ax1.bar( [2009+3.5/12], [1.72], width=1/6, color="k", label="Зарегистрированные смерти от гриппа А/H1N1 в 2009-10 гг")
    ax1.text(2001, -10, 'Source: Vivek Charu, et al, "Mortality Burden of the A/H1N1 Pandemic in Mexico"', fontsize=12)
    ax1.text(2010.2, 8, 'Пандемия A/H1N1', fontsize=12)
    ax1.plot( [2009+3/12,2010+4/12], [10, 10], "-", lw=2, color="k")   
    tks = range(2000,2021)
    tkslbl = []
    for i in tks:
        tkslbl += [str(i)]
    ax1.set_xticks(tks)
    ax1.set_xticklabels(tkslbl, fontsize=10)
    ax1.set_xlabel('Год (вертикальная линия - 1 января)')        
    ax1.set_ylabel('Смертей на млн в месяц')
    ax1.grid(True)
    ax1.set_xlim(2000, 2021)
    ax1.set_ylim(0, 90)
    ax1.legend(loc=2, fontsize=14 )
    plt.savefig( "./Graphs/020_Mexico_Flu_2.png")
    return

def Plot_Mexico_Flu3():
    WHO_Years = np.linspace(2012, 2020, 9)
    WHO_Flu = np.array(
        [2.876,0.493,9.015,0.680,5.549,4.114,1.231,6.446,2.171])
    Year, Total, Cardio_respiratory, Respiratory, Flu_pneumoia = Load_Calibration("./Data/Mexico_Flu.csv",
        ["Year", "Total", "Cardio_respiratory",	"Respiratory", "Flu_pneumoia"], separator='\t')
    Total_Sm = FilterN(Total, N=25)
    cc = Covid_Countries()
    cc.inputCountryFile( "Mexico", None)
    cou = cc.Countries["Mexico"]
    fig = plt.figure( figsize=(15,10))
    fig.suptitle( 'Смертность от ОРВИ и пневмонии в Мексике', fontsize=22)
    gs = plt.GridSpec(1, 1, height_ratios=[1]) 
    ax1 = plt.subplot(gs[0])
    #ax1.plot( Year, Cardio_respiratory, "-", lw=2, color="r", label="Все респираторные + cердечно-сосудистые")

    ax1.plot( Year[0:9]-2000+0.25, Respiratory[0:9], "-", lw=5, color="r", alpha=0.5, label="1999-2000")
    ax1.plot( Year[8:21]-2001+0.25, Respiratory[8:21], "-", lw=1, color="#FF7F00", label="2000-01")
    ax1.plot( Year[20:33]-2002+0.25, Respiratory[20:33], "-", lw=1, color="y", label="2001-02")
    ax1.plot( Year[32:45]-2003+0.25, Respiratory[32:45], "-", lw=1, color="g", label="2002-03")
    ax1.plot( Year[44:57]-2004+0.25, Respiratory[44:57], "-", lw=5, color="#00FFFF", alpha=0.5, label="2003-04 (Н3N3)")
    ax1.plot( Year[56:69]-2005+0.25, Respiratory[56:69], "-", lw=1, color="b", label="2004-05")
    ax1.plot( Year[68:81]-2006+0.25, Respiratory[68:81], "-", lw=1, color="m", label="2005-06")
    ax1.plot( Year[80:93]-2007+0.25, Respiratory[80:93], "-", lw=2, color="k", label="2006-07")
    ax1.plot( Year[92:105]-2008+0.25, Respiratory[92:105], "-", lw=2, color="#FF7F00", label="2007-08")
    ax1.plot( Year[104:111]-2009+0.25, Respiratory[104:111], "-", lw=2, color="y", label="2008-09")
    ax1.plot( Year[110:117]-2009+0.25, Respiratory[110:117], "-", lw=5, color="k", alpha=0.3, label="2009 (А/H1N1)")
    ax1.plot( Year[117:]-2010+0.25, Respiratory[117:], "-", lw=5, color="k", alpha=0.5, label="2010 (А/H1N1)")

    ax1.plot( Year[0:9]-2000+0.25, Flu_pneumoia[0:9], "--", lw=5, color="r", alpha=0.5)
    ax1.plot( Year[8:21]-2001+0.25, Flu_pneumoia[8:21], "--", lw=1, color="#FF7F00")
    ax1.plot( Year[20:33]-2002+0.25, Flu_pneumoia[20:33], "--", lw=1, color="y")
    ax1.plot( Year[32:45]-2003+0.25, Flu_pneumoia[32:45], "--", lw=1, color="g")
    ax1.plot( Year[44:57]-2004+0.25, Flu_pneumoia[44:57], "--", lw=5, color="#00FFFF", alpha=0.5)
    ax1.plot( Year[56:69]-2005+0.25, Flu_pneumoia[56:69], "--", lw=1, color="b")
    ax1.plot( Year[68:81]-2006+0.25, Flu_pneumoia[68:81], "--", lw=1, color="m")
    ax1.plot( Year[80:93]-2007+0.25, Flu_pneumoia[80:93], "--", lw=2, color="k")
    ax1.plot( Year[92:105]-2008+0.25, Flu_pneumoia[92:105], "--", lw=2, color="#FF7F00")
    ax1.plot( Year[104:111]-2009+0.25, Flu_pneumoia[104:111], "--", lw=2, color="y")
    ax1.plot( Year[110:117]-2009+0.25, Flu_pneumoia[110:117], "--", lw=5, color="k", alpha=0.3)
    ax1.plot( Year[116:]-2010+0.25, Flu_pneumoia[116:], "-", lw=5, color="k", alpha=0.5)

    #ax1.plot( Year[116:139]-2010+0.25, Respiratory[116:139], "-", lw=3, color="k", label="2010 (А/H1N1)")
    #ax1.plot( Year, Flu_pneumoia, "-", lw=2, color="k")
    #ax1.bar( WHO_Years+1/12, WHO_Flu, width=7/12, color="m", label="Тестированные смерти от гриппа 2011-2019 (WHO/Statista)")
    #aflu = np.average(Flu_pneumoia) 
    #ares = np.average(Respiratory) 
    #ax1.plot( [2000,2021], [aflu, aflu], "--", lw=2, color="m")   
    #ax1.plot( [2000,2021], [ares, ares], "--", lw=2, color="b")   
    #ax1.plot( [2011,2021], [6100/12, 6100/12], "--", lw=2, color="k", label="Общая смертность в 2019 г (ООН)")   
    ax1.bar( cou.Days/366+0.25, cou.dDeaths*30, width=1/366, color="r", alpha=0.5, label="COVID-19 (WHO)")
    ax1.plot( cou.Days/366+0.25, FilterN( cou.dDeaths, N=31)*30, '-', lw=5, color="m", label="COVID-19 (фильтр 31 день)")
    #ax1.bar( [2009+3.5/12], [1.72], width=1/6, color="k", label="Зарегистрированные смерти от гриппа А/H1N1 в 2009-10 гг")
    ax1.text(2001, -10, 'Source: Vivek Charu, et al, "Mortality Burden of the A/H1N1 Pandemic in Mexico"', fontsize=12)
    #ax1.text(2010.2, 8, 'Пандемия A/H1N1', fontsize=12)
    #ax1.plot( [2009+3/12,2010+4/12], [10, 10], "-", lw=2, color="k")   
    tks = np.linspace(1/24,1-1/24,12)
    ax1.set_xticks(tks)
    ax1.set_xticklabels(["Окт","Ноя","Дек","Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен"], fontsize=10)
    ax1.set_xlabel('Месяцы года (линия - 15 число месяца)')        
    ax1.set_ylabel('Смертей на млн в месяц')
    ax1.grid(True)
    ax1.set_xlim(-0.25, 1)
    ax1.set_ylim(0, 90)
    ax1.legend(loc=2, fontsize=14 )
    plt.savefig( "./Graphs/020_Mexico_Flu_2.png")
    return

#Plot_Mexico_Flu1()
#Plot_Mexico_Flu2()
Plot_Mexico_Flu3()
if InteractiveModeOn: plt.show(True)
